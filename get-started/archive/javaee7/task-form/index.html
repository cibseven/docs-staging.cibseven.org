<!DOCTYPE html>
<html class="no-js">
<head>
  
  <meta charset="utf-8" />

  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <meta name="viewport" content="width=device-width" />

  <meta name="description" content="documentation of CIB seven" />
  <meta name="keywords" content="camunda, cib seven, open source, free, Apache License, Apache 2.0, workflow, BPMN, BPMN 2.0, camunda.org, bpm, BPMS, engine, platform, process, automation, community, documentation" />
  <meta name="author" content="CIB software, CIB seven community" />
  

  <title>Implement a JSF Task Form for a BPMN User Task. | docs.cibseven.de</title>

  <meta name="generator" content="Hugo 0.136.4">
  <link rel="shortcut icon" href="/get-started/img/favicon.ico" type="image/x-icon" />

  

  <link rel="stylesheet" href="/get-started/css/docs.b3fedf4dfbf950a3c4bf2e26f0c445812357010c82caee6244f248eb4c57c20a.css" integrity="sha256-s/7fTfv5UKPEvy4m8MRFgSNXAQyCyu5iRPJI60xXwgo=">
  <link rel="canonical" href="/get-started/archive/javaee7/task-form/" />
</head>
<body class="">

<nav class="navbar navbar-fixed-top">
  <div class="navbar-container">
    <div class="navbar-header">
      <a href="/">
      <img src="/get-started/img/logo.png" style="padding:0 5px 7px 0;">
        <span class="site-name">Docs</span>
      </a>
    </div>

    <ul class="header-menu">
      
      <li  class="active"  ><a href="/get-started">Get Started</a></li>
      
      <li  ><a href="/manual">CIB seven</a></li>
      
      <li  ><a href="/security">Security</a></li>
      
    </ul>

    <button class="site-menu-toggle">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="search-field">
      <input type="search" class="search-input" placeholder="Search…" />
    </div>

    <ul class="external-menu">
      <li class="external"><a href="https://cibseven.de">cibseven.de</a></li>
    </ul>
  </div>
</nav>

<div class="search-results">
  <ul class="results-list">
  </ul>
  <footer>
    <button class="btn btn-default page previous">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </button>

    <button class="search-close btn btn-default">
      <span class="glyphicon glyphicon-remove"></span>
    </button>

    <button class="btn btn-default page next">
      <span class="glyphicon glyphicon-chevron-right"></span>
    </button>
  </footer>
</div>

<div class="search-underlay"></div>

<nav class="site-menu">
  



<div class="version">
  
</div>

<ul class="site-menu-items">
  
    
  <li>
    
      <a href="/get-started/quick-start/" >Quick Start (Java / JS)</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/quick-start/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/quick-start/service-task/" >Executable Process</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/quick-start/deploy/" >Deploy the Process</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/quick-start/user-task/" >Involve Humans</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/quick-start/gateway/" >Make It Dynamic</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/quick-start/decision-automation/" >Decision Automation</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="/get-started/spring-boot/" >Spring Boot</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/spring-boot/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/spring-boot/configuration/" >Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/spring-boot/model/" >Model a Process</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="/get-started/dmn/" >DMN</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/dmn/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/dmn/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/dmn/model/" >Create a Decision Table</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/dmn/deploy/" >Evaluate and Deploy the Decision Table</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/dmn/drg/" >Decision Requirements Graph</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="/get-started/archive/" >Archive</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/archive/spring/" >Spring Framework</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/archive/spring/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/spring/embedded-process-engine/" >Embedded Process Engine Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/spring/service-task/" >Spring Bean Service Task</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/spring/shared-process-engine/" >Shared Process Engine</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/" >Java EE 7</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/archive/javaee7/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/model/" >Model a Process</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/deploy/" >Deploy</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/start-form/" >JSF Start Form</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/service-task/" >EJB Service Task</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/task-form/" >JSF Task Form</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/javaee7/complete-process/" >Complete Process</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/" >Java Process Application</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/model/" >Model a Process</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/deploy/" >Deploy and Test</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/forms/" >Forms</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/java-process-app/service-task/" >Java Service Task</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/rpa/" >RPA Orchestration</a>
      <ul>
        
          
  <li>
    
      <a href="/get-started/archive/rpa/requirements/" >Requirements</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/rpa/installation/" >Installation &amp; Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/rpa/orchestrating-bots/" >Orchestrating RPA Bots</a>
    
  </li>

        
          
  <li>
    
      <a href="/get-started/archive/rpa/error-handling/" >Error Handling</a>
    
  </li>

        
      </ul>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="/get-started/apache-maven/" >Maven Coordinates</a>
    
  </li>

  
</ul>


<div class="meta">
  <h4 class="header">
    <span class="toggle glyphicon glyphicon-chevron-up"></span>
    Options
  </h4>

  <div class="content">
    <label for="version-select">Version:</label>
    <select id="version-select" data-basepath="/get-started" base-url="/get-started/">
      
    </select>
  </div>
</div>



</nav>


<div class="page-wrapper">


<div class="page-content">
  <div class="container-fluid">
    <div class="col-xs-12 content-header">
      
<div class="edit-on-github">
  <a target="_blank" href="https://github.com/cibseven/cibseven-docs-static/tree/master/get-started/content/archive%5cjavaee7%5ctask-form.md"><i>Edit on Github</i> <span class="cam-docs-github"></span></a>
</div>

      <h1 class="page-title">Implement a JSF Task Form for a BPMN User Task.</h1>
    </div>

    <div class="col-xs-12 content-text">
      <p>Now we add a task form and configure it in the BPMN 2.0 process, then, re-deploy the application and go to the Camunda Tasklist to see the JSF form.</p>
<figure class="image">
  <span><img
      src="../img/approve-order.png"
       /></span>
</figure>

<p>After the order has been persisted, a user can approve the order. For that, a task form is needed to display the order information and backend logic to fetch and update business objects.</p>
<h1 id="add-a-cdi-controller-bean">Add a CDI Controller Bean</h1>
<p>To update the persisted entity we use a named CDI Bean <code>ApproveOrderController</code>. To gather the persisted order entity, we get the order id from the process variables of the <code>businessProcess</code>. With the id we can load the order entity through the order business logic. After the order has been updated, the detached entity state is merged by the order business logic.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> org.camunda.bpm.getstarted.pizza;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.camunda.bpm.engine.cdi.BusinessProcess;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.camunda.bpm.engine.cdi.jsf.TaskForm;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.enterprise.context.ConversationScoped;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.inject.Inject;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.inject.Named;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.persistence.EntityManager;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.persistence.PersistenceContext;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.io.Serializable;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Named</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ConversationScoped</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ApproveOrderController</span> <span style="color:#66d9ef">implements</span> Serializable {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span>  <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 1L;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Inject the BusinessProcess to access the process variables</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> BusinessProcess businessProcess;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Inject the EntityManager to access the persisted order</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@PersistenceContext</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> EntityManager entityManager;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Inject the OrderBusinessLogic to update the persisted order</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> OrderBusinessLogic orderBusinessLogic;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Caches the OrderEntity during the conversation</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> OrderEntity orderEntity;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> OrderEntity <span style="color:#a6e22e">getOrderEntity</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (orderEntity <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Load the order entity from the database if not already cached</span>
</span></span><span style="display:flex;"><span>      orderEntity <span style="color:#f92672">=</span> orderBusinessLogic.<span style="color:#a6e22e">getOrder</span>((Long) businessProcess.<span style="color:#a6e22e">getVariable</span>(<span style="color:#e6db74">&#34;orderId&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> orderEntity;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">submitForm</span>() <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Persist updated order entity and complete task form</span>
</span></span><span style="display:flex;"><span>    orderBusinessLogic.<span style="color:#a6e22e">mergeOrderAndCompleteTask</span>(orderEntity);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="extend-order-business-logic">Extend Order Business Logic</h1>
<p>The order business logic is extended to provide a method to load an order entity from the database by order id, to merge a detached order entity and to complete the task form. For that, the task form is injected, which is provided by the Camunda CDI artifact.</p>
<p>Please note that the merging of the detached order entity and the completion of the task form are intentionally placed in one method. This ensures that both operations are executed in a single transaction. An error during that transaction will rollback both changes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Stateless</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Named</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">OrderBusinessLogic</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Inject task form available through the Camunda cdi artifact</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">@Inject</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> TaskForm taskForm;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">persistOrder</span>(DelegateExecution delegateExecution) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> OrderEntity <span style="color:#a6e22e">getOrder</span>(Long orderId) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Load order entity from database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> entityManager.<span style="color:#a6e22e">find</span>(OrderEntity.<span style="color:#a6e22e">class</span>, orderId);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Merge updated order entity and complete task form in one transaction. This ensures
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    that both changes will rollback if an error occurs during transaction.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">mergeOrderAndCompleteTask</span>(OrderEntity orderEntity) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Merge detached order entity with current persisted state</span>
</span></span><span style="display:flex;"><span>    entityManager.<span style="color:#a6e22e">merge</span>(orderEntity);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Complete user task from</span>
</span></span><span style="display:flex;"><span>      taskForm.<span style="color:#a6e22e">completeTask</span>();
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Rollback both transactions on error</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(<span style="color:#e6db74">&#34;Cannot complete task&#34;</span>, e);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="create-a-jsf-form-task-form">Create a JSF Form Task Form</h1>
<p>Add a file named <code>approveorder.xhtml</code> to the <code>src/main/webapp</code> folder. Add the following content:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE HTML&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span> <span style="color:#a6e22e">xmlns</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.w3.org/1999/xhtml&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:ui</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://java.sun.com/jsf/facelets&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:h</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://java.sun.com/jsf/html&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xmlns:f</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://java.sun.com/jsf/core&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">f:view</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">f:metadata</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">&lt;!-- Start working on a task. Task Id is read internally from
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       request parameters and cached in the CDI conversation scope.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">      --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">f:event</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;preRenderView&#34;</span> <span style="color:#a6e22e">listener</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#{camundaTaskForm.startTaskForm()}&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">f:metadata</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">h:head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Approve Order&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">h:head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">h:body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h1</span>&gt;Order:&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;Customer: #{approveOrderController.orderEntity.customer}&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;Address: #{approveOrderController.orderEntity.address}&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;Pizza: #{approveOrderController.orderEntity.pizza}&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h:form</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submitForm&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h:outputLabel</span>&gt;Approve Order?&lt;/<span style="color:#f92672">h:outputLabel</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h:selectBooleanCheckbox</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#{approveOrderController.orderEntity.approved}&#34;</span>/&gt;&lt;<span style="color:#f92672">br</span>/&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h:commandButton</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit_button&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Approve Order&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#{approveOrderController.submitForm()}&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">h:form</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">h:body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">f:view</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>The JSF view displays the order properties and provides a checkbox to approve the order on submit. Additionally, an event listener is configured which is triggered before the view is rendered. It will call the <code>camundaTaskForm.startTaskForm()</code> method which extracts the task id from the URL and starts a conversation for the task form.</p>
<p>When the user approves or disapproves the order, it is directly set on the cached order entity.</p>
<p>On form submit, the <code>approveOrderController.submitForm()</code> method calls the EJB <code>mergeOrderAndCompleteTask</code> method with the cached order entity. The EJB will merge the updated order entity if necessary and completes the task form.</p>
<h1 id="configure-the-task-form-in-the-process">Configure the Task Form in the Process</h1>
<figure class="image">
  <span><img
      src="../img/pizza-order-process-task-form.png"
       /></span>
</figure>

<p>Open the process with the modeler. Click on the <em>Approve Order</em> user task. In the properties view, set the <code>Form Key</code> property to <code>app:approveorder.jsf</code>. This means that we want to use an external JSF form and that the form is loaded from the application.</p>
<h1 id="configure-the-conditional-sequence-flows-in-the-process">Configure the Conditional Sequence Flows in the Process</h1>
<figure class="image">
  <span><img
      src="../img/pizza-order-process-no.png"
       /></span>
</figure>

<p>Open the process with the modeler. In the properties view, set the <code>Condition</code> property of the conditional sequence flows after the exclusive gateway to <code>${orderBusinessLogic.getOrder(orderId).approved}</code> respectively <code>${not orderBusinessLogic.getOrder(orderId).approved}</code>.</p>
<p>When you are done, save all resources, <a href="../deploy/#build-the-process-application">perform a Maven build</a>, and <a href="../deploy/#deploy-to-wildfly">redeploy</a> the process application. Start the process <code>Order Pizza</code> in <a href="http://localhost:8080/camunda/app/tasklist">Tasklist</a>. Fill out the emerging form. Select the <code>All Tasks</code> element on the left side of Tasklist. An <code>Approve Order</code> task should then be listed in the tasklist. Go to the task and press on <button class="btn btn-xs">
  <i class="glyphicon glyphicon-user" ></i> Claim
</button>
. Now you can approve the pizza order.</p>

<div class="panel-group gs-download-step-panel" id="gitStep-6">
  <div class="panel panel-success">
    <div class="panel-heading">
      <div class="pull-right">
        <a class="btn btn-success gs-download-step-btn" href="https://github.com/cibseven/camunda-get-started-javaee/archive/Step-6.zip">
          <span i class="glyphicon glyphicon-download-alt"></span>
          Source Code Step-6
        </a>
      </div>
      <h4>Catch up: Get the Sources of Step-6.</h4>
      <p class="text-muted">
        <a href="https://github.com/cibseven/camunda-get-started-javaee/archive/Step-6.zip">Download as .zip</a>
        or checkout the corresponding tag with <a class="toggle-instructions">Git</a>.
      </p>
    </div>
    <div class="panel-body">
      <p>You can checkout the current state from the <a href="https://github.com/cibseven/camunda-get-started-javaee">GitHub repository</a>.</p>
      <p>If you have not cloned the repository yet, please execute the following command:
      <pre class="console">git clone https://github.com/cibseven/camunda-get-started-javaee.git</pre>
      </p>
      <p>
      To checkout the current state of the process application please execute the following command:
      <pre class="console">git checkout -f Step-6</pre>
      Or download as archive from <a href="https://github.com/cibseven/camunda-get-started-javaee/releases/tag/Step-6">here</a>.
      </p>
    </div>
  </div>
</div>


    </div>
  </div>
</div>

<div class="page-toc">
  <h3>On this Page:</h3>
  <nav id="TableOfContents"></nav>
  <div class="docs-banner" style="display:none">
 :(
</div>

</div>


    
    <footer class="page-footer">
      <div class="row">
        <div class="col-xs-12">

          <p class="pull-right">
            <a href="#" target="_self">Back to top</a>
          </p>

          <p>
            <a href="http://cibseven.de">cibseven.de</a> and <a href="http://docs.cibseven.de">docs.cibseven.de</a> are part of CIB seven project — <a href="https://www.cib.de/en/privacy-policy/">Privacy Statement</a> – <a href="https://www.cib.de/en/legal-advice/">CIB software GmbH</a>
            <br/>The CIB seven documentation is based on <a href="https://docs.camunda.org/">Camunda 7 Docs</a> from Camunda. Some redesign & naming adoptation was made.
          </p>
          <p>
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a> The content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
          </p>
        </div>
      </div>
    </footer>
  </div>


  

  <script type="text/javascript" src="/get-started/js/docs.f2c4b7c6c0f26856db0d2a99f49b8f70f5c29f4fac61b696eee23a7f5b23fa62.js" integrity="sha256-8sS3xsDyaFbbDSqZ9JuPcPXCn0&#43;sYbaW7uI6f1sj&#43;mI="></script>
</body>
</html>

